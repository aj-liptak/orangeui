<script type="text/javascript" src="lib/jquery-1.7.2.min.js"></script>
<script src="src/commons.js" type="text/javascript"></script>
<script src="src/mvc.js" type="text/javascript"></script>
<script src="src/db.js" type="text/javascript"></script>
<script src="src/ui.js" type="text/javascript"></script>
<script src="plugins/cakephp/cakephp.js" type="text/javascript"></script>
<script src="lib/socket.io.js" type="text/javascript"></script>
<script src="lib/inflection.js" type="text/javascript"></script>

<!--<script src="modules/rest.js" type="text/javascript"></script>
<script src="modules/cakephp.js" type="text/javascript"></script>
-->

<script type="text/javascript">

Orange.use('mvc', 'db', 'cakephp', 'ui', function(O) {

	var Ajax = __import('Ajax'), Model = __import('Model'), ViewController = __import('ViewController');
		
	var source = new O.CakePHP.CakeSource({
		name: 'contacts',
		path: '/contacts/'
	});
	
	var Contact = Model.extend({
	
		getName: function() {
			return 'contact';
		},
		
		getId: function() {
			return 'id';
		},
		
		getFields: function() {
			return {
				contactId: { name: 'id', type: 'key', nullable: false, primaryKey: true },
				firstName: { name: 'first_name', type: 'text', nullable: false },
				lastName: { name: 'last_name', type: 'text', nullable: false },
				email: { name: 'email', type: 'email', nullable: true }
			}
		},
		
		getSource: function() {
			return source;
		}
	
	});
	
	var MyView = ViewController.extend({
	
		getType: function() {
			return 'my-view'
		},
		
		getBindings: function() {
			return {
				'test': { 'click': true }
			}
		},
		
		onWillLoad: function() {

		},
		
		onClick: function(e) {
			alert("!@3");
		}
	
	});
	
	var AnotherView = MyView.extend({
	
		getType: function() {
			return 'another-view'
		}
	
	});
	
	var test = new O.Application('test', {
		location: true,
		logging: 'INFO',
		poll: false,
		required: ['db', 'mvc', 'ui', 'cakephp']
	});
	
	test.launch();

});


</script>

<body>

<div data-control="view" data-name="test-view" data-root="true">

	<p>Hello</p>
	
	<div data-control="my-view" data-name="arg">
	
		<p data-name="test">Test</p>
	
	</div>
	
	<div data-control="another-view" data-name="blurg">
	
	</div>

</div>

</body>