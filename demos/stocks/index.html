<!DOCTYPE html>
<html>

<head>

<meta http-equiv="Content-type" content="text/html; charset=utf-8">

<title>TickerType</title>

<script type="text/javascript" src="http://code.jquery.com/jquery-1.8.0.min.js"></script>
<script type="text/javascript" src="lib/md5.min.js"></script>
<script type="text/javascript" src="../../build/0.5.0/orange-0.5.0.js"></script>

<script type="text/javascript" src="js/config.js"></script>
<script type="text/javascript" src="js/controllers.js"></script>
<script type="text/javascript" src="js/models.js"></script>
<script type="text/javascript" src="js/services.js"></script>

<script type="text/javascript">

Orange.use('tickertype-models', 'tickertype-services', function() {

  var AccountService = include('tickertype-services').AccountService;
  var PortfolioService = include('tickertype-services').PortfolioService;
  var QuoteService = include('tickertype-services').QuoteService;
  
  var as = new AccountService();
  
  function success(data) {
    console.log('success', data.toObject());
  }
  
  function failure() {
    console.log("failed", arguments);
  }
  
  as.authenticate('kevin.kinnebrew@gmail.com', 'pass', success, failure);
  
  var ps = new PortfolioService();
  
  ps.getPortfolio(function(data) {
    
    console.log('success', data.toObject());
  
    ps.getPositionsForPortfolio(data, function(data) {
            
      var collection = [];
      
      for (var i=0; i<data.length; i++) {
        collection.push(data[i].toObject());
      }
      
      console.log('success', collection);
      
      ps.getLinesForPosition(data[1], function(data) {
      
        var collection = [];
        
        for (var i=0; i<data.length; i++) {
          collection.push(data[i].toObject());
        }
        
        console.log('success', collection);
      
      }, failure);
      
    }, failure);
  
  }, failure);
  
  var qs = new QuoteService();
  
  qs.getSymbol('BAC', success, failure);
  
  
});

</script>

<link type="text/css" rel="stylesheet" href="css/app.css"

</head>

<body>

<h1>TickerType</h1>

</body>

</html>