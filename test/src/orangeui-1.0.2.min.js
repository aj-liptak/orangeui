(function(){function z(){}function A(a){var b=a instanceof Array?[]:{};for(i in a){if(i=="clone")continue;if(a[i]&&typeof a[i]=="object"){b[i]=A(a[i])}else b[i]=a[i]}return b}function B(a,b){var b=$(b).eq(0);var a=$(a)[0];for(i=0;i<a.attributes.length;i++){var c=a.attributes[i];b.attr(c.name,c.value)}}var a,b,c,d,e,f,g,h,j,k,l,m,n,o,p,q,r,s,t=function(b){return a[b]},u=function(b,c){a[b]=c},v=/[^A-Za-z:0-9_\[\]]/g;f=function(){function c(){}var a=false,b=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/;c.extend=function(c){function g(){if(!a&&this.initialize){this.initialize.apply(this,arguments)}}var d=this.prototype;a=true;var e=new this;a=false;for(var f in c){e[f]=typeof c[f]=="function"&&typeof d[f]=="function"&&b.test(c[f])?function(a,b){return function(){var c=this._super;this._super=d[a];var e=b.apply(this,arguments);this._super=c;return e}}(f,c[f]):c[f]}g.prototype=e;g.prototype.constructor=g;g.extend=arguments.callee;return g};c.include=function(a,b){var d=new a;for(var e in b){a[e]=b[e]}c.prototype=d};c.proxy=function(a,b){var c=b;return function(){return a.apply(c,arguments)}};return c}();d=f.extend({initialize:function(a,b){this.name=a;this.config=b;this.isOnline=false},goOnline:function(){this.isOnline=true},goOffline:function(){this.isOnline=false},isOnline:function(){return this.isOnline}});j=function(){function a(a,b,c,d){this.bubbles=true;this.type=a;this.currentTarget=b;this.target=c;this.data=d}a.prototype.stopPropagation=function(){this.bubbles=false};return a}();h=f.extend({initialize:function(a,b){this._listeners={};this._parent=a;this._self=b},on:function(a,b){if(typeof this._listeners[a]==="undefined"){this._listeners[a]=[]}this._listeners[a].push(b)},fire:function(a,b){var c=this._parent;if(typeof a==="string")a=new j(a,this._self,this._self,b);if(typeof a.type!=="string")throw"Error: Invalid 'type' when firing event";if(this._listeners[a.type]instanceof Array){var d=this._listeners[a.type];for(var e=0,f=d.length;e<f;e++)d[e].call(this,a)}if(c!=null&&c._eventTarget instanceof j&&a.bubbles){a.currentTarget=this._parent;c._eventTarget.fire.call(c._eventTarget,a,b)}},detach:function(a,b){if(this._listeners[a]instanceof Array){var c=this._listeners[a];for(var d=0,e=c.length;d<e;d++){if(typeof b!=="undefined"&&c[d]===b){c.splice(d,1);break}else c.splice(d,1)}}else if(typeof a==="undefined"){this._listeners={}}},destroy:function(){for(var a in this._listeners){a.detach()}delete this._parent;delete this._self}});s=function(){function d(){}var a=window.localStorage,b=false,c=false;d.init=function(){if("localStorage"in window){try{window.localStorage.setItem("_test",1);b=true;window.localStorage.removeItem("_test")}catch(c){}}if(b){try{if(window.localStorage){a=window.localStorage}}catch(c){}}else if("globalStorage"in window){try{if(window.globalStorage){a=window.globalStorage[window.location.hostname];b=true}}catch(c){}}else{}if(typeof JSON==="undefined"||JSON.stringify==undefined){b=false}if(b)o.info("Local storage loaded");else o.debug("Local storage not supported")};d.get=function(d,e){if(!b)return;try{var f=JSON.parse(a.getItem(d));if(f!=undefined&&f.data!=undefined){if(c&&f.ttl!==-1&&(new Date).getTime()-f.timestamp>f.ttl){a.removeItem(d)}return f.data}}catch(g){o.error("Error saving object to localStorage")}return e};d.set=function(c,d,e){if(!b)return false;c=c.replace(v,"");if(typeof d==="undefined")return false;var f={data:d,timestamp:(new Date).getTime(),ttl:e?e:24*60*60*1e3};try{a.setItem(c,JSON.stringify(f));return true}catch(g){if(g==QUOTA_EXCEEDED_ERR){o.error("Storage quota has been exceeded",g)}}return false};d.remove=function(c){if(!b)return false;a.removeItem(c)};d.flushExpired=function(e){if(!b)return;if(c===false&&e!==true)return;for(var f in a){d.get(f)}};d.flush=function(d){if(!b)return;if(c===false&&d!==true)return;a.clear();o.info("Clear: Local storage cleared")};d.isSupported=function(){return b};return d}();b=function(){function c(){}var a=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}];var b=function(){var b=false;for(var c=0,d=a.length;c<d;c++){try{b=a[c]()}catch(e){continue}}return b};c.load=function(a){if($){return $.ajax(a).responseText}else{var c=b();if(!c)return;var d,e,f;if(typeof a.success==="function")d=a.success;if(typeof a.error==="function")e=a.error;if(a.hasOwnProperty("data"))f=a.data;var g=a.hasOwnProperty("type")?a.type:"GET";c.open(g,url,true);c.setRequestHeader("Cache-Control","no-cache");c.timeout=3e3;c.ontimeout=function(){e(c)};c.setRequestHeader("Content-type","application/x-www-form-urlencoded");c.onreadystatechange=function(){if(c.readyState!=4)return;if(c.status!=200&&c.status!=304){e(c)}d(c)};if(c.readyState==4){d(c);return}c.send(f)}};c.get=function(a){a.type="GET";return c.load(a)};c.post=function(a){a.type="POST";return c.load(a)};c.put=function(a){a.type="PUT";return c.load(a)};c.delete=function(a){a.type="DELETE";return c.load(a)};return c}();e=function(){function s(){}var a=null,c=false,d=false,e=false,f=false;var g=function(){if(a!=null){clearTimeout(a);a=null}};var i=function(){if(navigator.onLine&&!e){d=true;e=true;s.fire("statusChange",1);return}g();a=setTimeout(function(){if(navigator.onLine&&!e){d=true;e=true;s.fire("statusChange",1)}else if(navigator.onLine){b.load({url:"ping.js",type:"GET",success:function(a){if(d===false)s.fire("statusChange",1);d=true},error:function(a){if(d===true)s.fire("statusChange",0);d=false}})}else{setTimeout(function(){if(d===true)s.fire("statusChange",0);d=false},100)}a=null;if(c)setTimeout(i,10*1e3)},e?100:0)};var j=function(a){o.debug("Cache: All resources for this app downloaded. You can run this application while not connected to the internet")};var k=function(){o.debug("Cache: Checking for cache manifest")};var l=function(){o.debug("Cache: Starting download of cached files")};var m=function(){o.debug("Cache: There was an error in the manifest, downloading cached files or you're offline")};var n=function(){o.debug("Cache: There was no update needed")};var p=function(){o.debug("Cache: Downloading cached files")};var r=function(){window.applicationCache.swapCache();o.debug("Cache: Updated cache has been loaded and is ready");window.location.reload(true)};s._events=new h(null,s);s.on=function(a,b,c){var d=typeof c!=="undefined"?function(){b.apply(c,arguments)}:b;return this._events.on.call(this._events,a,d)};s.fire=function(){return this._events.fire.apply(this._events,arguments)};s.detach=function(){return this._events.detach.apply(this._events,arguments)};s.init=function(a){if(f)return;c=a;f=true;q.bind(window,"offline",i);q.bind(window,"online",i);q.bind(window,"cached",j);q.bind(window,"checking",k);q.bind(window,"downloading",l);q.bind(window,"error",m);q.bind(window,"noupdate",n);q.bind(window,"progress",p);q.bind(window,"updateready",r);i()};s.updateNetworkStatus=function(a){i()};s.isActive=function(){return f};s.isOnline=function(){return d};return s}();n=function(){function d(){}var a=null,b=null,c=60*60*1e3;d.fetch=function(c,e){if(!d.isExpired()){if(typeof c!=="undefined")c(a)}else{if(navigator.geolocation){navigator.geolocation.getCurrentPosition(function(d){b=(new Date).getTime();a=d.coords;o.info("Location retrieved");if(typeof c=="function")c(d.coords)},function(a){switch(a.code){case a.TIMEOUT:o.error("Location services timeout");break;case a.POSITION_UNAVAILABLE:o.error("Position unavailable");break;case a.PERMISSION_DENIED:o.error("Please Enable Location Services");break;default:o.error("Unknown location services error");break}if(typeof a==="function")a()})}}};d.isExpired=function(){return(new Date).getTime()-b>c};return d}();o=function(){function a(){}a._events=new h(null,a);a.on=function(a,b,c){var d=typeof c!=="undefined"?function(){b.apply(c,arguments)}:b;return this._events.on.call(this._events,a,d)};a.fire=function(){return this._events.fire.apply(this._events,arguments)};a.detach=function(){return this._events.detach.apply(this._events,arguments)};if(typeof console=="undefined"){console={log:function(){},dir:function(){}}}a.info=function(a,b){console.info(a)};a.debug=function(a,b){console.debug(a)};a.warn=function(a,b){console.warn(a)};a.error=function(a,b){console.error(a)};return a}();r=f.extend({initialize:function(a){this.config=a},getName:function(){return this.config.name},isPersistent:function(){return false}});m=r.extend({isPersistent:function(){return true},getPath:function(a){return this.getName()+":"+"model:"+a},getAll:function(a){return s.get(this.getPath(a))||undefined},get:function(a,b){var c=s.get(this.getPath(a))||{};return c.hasOwnProperty(b)?c[b]:undefined},set:function(a,b,c){if(b===null)b=this.nextKey(a);var d=s.get(this.getPath(a));d=d||{};d[b]=c;s.set(this.getPath(a),d);return b},remove:function(a,b){var c=s.get(this.getPath(a));delete c[b];s.set(this.getPath(a),c);return true},flush:function(a){s.remove(this.getPath(a))},nextKey:function(a){var b=0,c,d=[];var e=s.get(this.getPath(a));for(c in e){if(e.hasOwnProperty(c)&&!isNaN(c))d.push(parseInt(c,10))}return d.length>0?Math.max.apply(Math,d)+1:1}});c=r.extend({initialize:function(a){this.config=a},request:function(a){if(e.isActive()&&!e.isOnline()){o.warn("Could not connect to server");return}var c=typeof a.success==="function"?a.success:null;var d=typeof a.error==="function"?a.error:null;var f=typeof a.complete==="function"?a.complete:null;if(typeof a.context!=="undefined"){if(c)c=function(){c.apply(context,arguments)};if(d)d=function(){d.apply(context,arguments)};if(f)f=function(){f.apply(context,arguments)}}var g={url:a.url,type:a.type};if(a.hasOwnProperty("async"))g.async=a.async;if(a.hasOwnProperty("data"))g.data=a.data;if(a.hasOwnProperty("dataType"))g.dataType=a.dataType;if(a.hasOwnProperty("contentType"))g.contentType=a.contentType;if(c)g.success=c;if(d)g.error=d;if(f)g.complete;return b.load(g)}});p=f.extend({initialize:function(a){this.config=a;this._events=new h(null,this);for(var b in a.fields){if(a.fields[b].name==a.id)this.config.key=b}if(this.config.key===null)throw"Missing id field in model '"+this.getName()+"'"},getName:function(){return this.config.name},getKey:function(){return this.config.key},getId:function(){return this.config.id},getFields:function(){return this.config.fields},getSource:function(){return this.config.source},getAll:function(a,b,c){var d=function(a){var c=this.mapItems(a);b.call(this,new g(this,c))};this.getSource().getAll(this.getName(),f.proxy(d,this),c)},get:function(a,b,c){var d=function(a){var c=this.mapItem(a);b.call(this,new k(this,c))};this.getSource().get(this.getName(),a,f.proxy(d,this),c)},set:function(a,b,c){var d=a.hasOwnProperty("id")?a[d]:null;var e=function(a){var c=this.mapItem(a);b.call(this,new k(this,c))};this.getSource().set(this.getName(),d,this.unmapItem(a),f.proxy(e,this),c)},remove:function(a,b,c){var d=a;var e=function(a){b.call(this,d)};this.getSource().remove(this.getName(),a,f.proxy(e,this),c)},on:function(a,b,c){var d=typeof c!=="undefined"?function(){b.apply(c,arguments)}:b;return this._events.on.call(this._events,a,d)},fire:function(){return this._events.fire.apply(this._events,arguments)},detach:function(){return this._events.detach.apply(this._events,arguments)},mapItem:function(a){var b={},c=this.getFields();for(var d in c){var e=c[d].name,f=a.hasOwnProperty(e)?a[e]:undefined;if(f===undefined){o.warn("Could not parse JSON field '"+d+"' for "+this.getName());continue}b[d]=f}return b},mapItems:function(a){var b=[];for(var c=0,d=a.length;c<d;c++){var e=this.mapItem(a[c]);if(typeof e==="object")b.push(e)}return b},unmapItem:function(a){var b={},c=this.getFields();for(var d in c){if(this.getKey()==d&&!a.hasOwnProperty(this.getKey())){continue}var e=c[d].name,f=typeof a[d]!=="undefined"?a[d]:undefined;if(f===undefined&&!c[d].nullable){o.warn("Missing data for field '"+d+"' for "+this.getName());continue}b[e]=f}return b}});g=f.extend({initialize:function(a,b){this.model=a;this.data=b;this.active=b;this.list=this.toArray()},getModel:function(){return this.model},count:function(){return this.list.length},get:function(a){return this.data.hasOwnProperty(a)?new k(this.model,this.data[a]):undefined},filter:function(a){if(typeof a==="function"&&this.active!==undefined){for(var b in this.active){if(!a.call(this,this.active[b]||{}))delete this.active[b]}}},clearFilters:function(){this.active=this.data},toArray:function(){var a=[];for(var b in this.active){a.push(this.active[b])}return a},toObject:function(){return this.data}});k=f.extend({initialize:function(a,b){this.model=a;this.id=b[this.model.getKey()];this.data=b;this.isSaved=true},get:function(a){return this.data.hasOwnProperty(a)?this.data[a]:undefined},set:function(a,b){this.data[a]=b;this.isSaved=false},clear:function(a){delete this.data[a];this.isSaved=false},isSaved:function(){return this.isSaved},exists:function(){return typeof this.id!==undefined},save:function(){this.model.set(this.id,this.data,f.proxy(function(){this.isSaved=true},this),function(a){})},remove:function(){this.model.remove(this.id,f.proxy(function(){this.isSaved=true;this.id=undefined},this),function(a){})},refresh:function(){this.data=this.model.get(this.id);this.isSaved=true},toObject:function(){return this.data}});q=function(){function a(a){if($){this.target=$(a);this.jQuery=true}else this.target=document.getElementById(a)}a.bind=function(a,b,c){if(a.addEventListener){a.addEventListener(b,c,false)}else if(a.attachEvent){a.attachEvent("on"+b,c)}};a.unbind=function(a,b,c){if(a.removeEventListener){a.removeEventListener(b,c,false)}else if(a.detachEvent){a.detachEvent("on"+b,c)}};a.on=function(){a.bind.apply(a,arguments)};a.off=function(){a.bind.apply(a,arguments)};a.prototype.bind=function(b,c,d){a.bind(this.target,c,d)};a.prototype.unbind=function(b,c,d){a.unbind(this.target,c,d)};return a}();l=function(){function c(){}var b={};c.addModule=function(a,c,d){a=a.replace(/[^-A-Za-z_]/g);var e={name:a,fn:c,req:d!=undefined?d:[]};b[a]=e};c.loadModule=function(d){if(a.modules.hasOwnProperty(d))return;if(b[d]!=undefined){a.modules[d]=true;for(var e=0,f=b[d].req.length;e<f;e++){if(b[d].req[e]===d)continue;c.loadModule(b[d].req[e])}b[d].fn.call(window,a);o.info('Module "'+d+'" loaded')}};return c}();var w=function(){var a=arguments,b=a[0],c=typeof a[1]==="function"?a[1]:null,d=a[2];l.addModule(b,c,d)};var x=function(){var b=Array.prototype.slice.call(arguments),c=b[b.length-1],d=A(b).splice(0,b.length-1);if(typeof d[0]!="function"){for(var e=0,f=d.length;e<f;e++){l.loadModule(d[e])}}c.call(window,a)};var y=function(b){if(a[b]==undefined){a[b]={}}};a=this.Orange={};a.version="1.0.2";a.__import=this.__import=t;a.__export=this.__export=u;a.modules={};a.add=w;a.use=x;a.namespace=y;a.Ajax=b;a.AjaxSource=c;a.Application=d;a.Cache=e;a.Class=this.Class=f;a.Events=h;a.EventTarget=j;a.Item=k;a.Loader=l;a.LocalStorageSource=m;a.Location=n;a.Log=o;a.Model=p;a.Node=q;a.Source=r;a.Storage=s}).call(this)